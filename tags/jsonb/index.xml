<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/"><channel><title>Jsonb on j2gl bytes</title><link>https://j2gl.github.io/tags/jsonb/</link><description>Recent content in Jsonb on j2gl bytes</description><generator>Hugo -- 0.152.2</generator><language>en-us</language><lastBuildDate>Thu, 13 May 2021 19:34:42 +0200</lastBuildDate><atom:link href="https://j2gl.github.io/tags/jsonb/index.xml" rel="self" type="application/rss+xml"/><item><title>Filter jsonb Array Data in PostgreSQL</title><link>https://j2gl.github.io/posts/filter-jsonb-postgresql/</link><pubDate>Thu, 13 May 2021 19:34:42 +0200</pubDate><guid>https://j2gl.github.io/posts/filter-jsonb-postgresql/</guid><description>&lt;h2 id="filtering-jsonb-array-data-in-postgresql"&gt;Filtering &lt;code&gt;jsonb&lt;/code&gt; Array Data in PostgreSQL&lt;/h2&gt;
&lt;p&gt;One day, I faced a challenge: how do you filter rows in a PostgreSQL table when the data you want to query lives inside a &lt;code&gt;jsonb&lt;/code&gt; array?&lt;/p&gt;
&lt;p&gt;Let me walk you through the solution step by step.&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id="the-setup"&gt;The Setup&lt;/h2&gt;
&lt;p&gt;We will ll start by creating a temporary table called &lt;code&gt;table1&lt;/code&gt; with some JSON data stored in a column named &lt;code&gt;dummy_data&lt;/code&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-sql" data-lang="sql"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#66d9ef"&gt;CREATE&lt;/span&gt; TEMP &lt;span style="color:#66d9ef"&gt;TABLE&lt;/span&gt; table1 &lt;span style="color:#66d9ef"&gt;AS&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;SELECT&lt;/span&gt; id::int, dummy_data::jsonb &lt;span style="color:#66d9ef"&gt;FROM&lt;/span&gt; (
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;VALUES&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; (&lt;span style="color:#ae81ff"&gt;1&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;[
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#e6db74"&gt; {&amp;#34;code&amp;#34;: &amp;#34;AB123456&amp;#34;, &amp;#34;other&amp;#34;: &amp;#34;xxx&amp;#34;, &amp;#34;amount&amp;#34;: 10, &amp;#34;step&amp;#34;: &amp;#34;STEP_1&amp;#34;},
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#e6db74"&gt; {&amp;#34;code&amp;#34;: &amp;#34;HH654654&amp;#34;, &amp;#34;other&amp;#34;: null, &amp;#34;amount&amp;#34;: 20, &amp;#34;step&amp;#34;: &amp;#34;STEP_2&amp;#34;}
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#e6db74"&gt; ]&amp;#39;&lt;/span&gt;),
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; (&lt;span style="color:#ae81ff"&gt;2&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;[
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#e6db74"&gt; {&amp;#34;code&amp;#34;: &amp;#34;45648asd&amp;#34;, &amp;#34;other&amp;#34;: null, &amp;#34;amount&amp;#34;: 30, &amp;#34;step&amp;#34;: &amp;#34;STEP_1&amp;#34;},
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#e6db74"&gt; {&amp;#34;code&amp;#34;: &amp;#34;QWERASDF&amp;#34;, &amp;#34;other&amp;#34;: &amp;#34;asdf&amp;#34;, &amp;#34;amount&amp;#34;: 40, &amp;#34;step&amp;#34;: &amp;#34;STEP_2&amp;#34;}
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#e6db74"&gt; ]&amp;#39;&lt;/span&gt;),
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; (&lt;span style="color:#ae81ff"&gt;3&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;[]&amp;#39;&lt;/span&gt;),
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; (&lt;span style="color:#ae81ff"&gt;4&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;[
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#e6db74"&gt; {&amp;#34;code&amp;#34;: &amp;#34;POIUASDF&amp;#34;, &amp;#34;other&amp;#34;: null, &amp;#34;amount&amp;#34;: 50, &amp;#34;step&amp;#34;: &amp;#34;STEP_1&amp;#34;},
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#e6db74"&gt; {&amp;#34;code&amp;#34;: &amp;#34;SFDTGFDJ&amp;#34;, &amp;#34;other&amp;#34;: null, &amp;#34;amount&amp;#34;: 60, &amp;#34;step&amp;#34;: &amp;#34;STEP_2&amp;#34;},
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#e6db74"&gt; {&amp;#34;code&amp;#34;: &amp;#34;DFGERUDD&amp;#34;, &amp;#34;other&amp;#34;: &amp;#34;1234&amp;#34;, &amp;#34;amount&amp;#34;: 70, &amp;#34;step&amp;#34;: &amp;#34;STEP_3&amp;#34;},
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#e6db74"&gt; {&amp;#34;code&amp;#34;: &amp;#34;34567DTH&amp;#34;, &amp;#34;other&amp;#34;: null, &amp;#34;amount&amp;#34;: 80, &amp;#34;step&amp;#34;: &amp;#34;STEP_4&amp;#34;}
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#e6db74"&gt; ]&amp;#39;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; ) &lt;span style="color:#66d9ef"&gt;AS&lt;/span&gt; t(id, dummy_data);
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;This creates a table with data similar to the following:&lt;/p&gt;</description></item></channel></rss>